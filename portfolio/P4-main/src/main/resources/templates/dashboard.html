<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hue Lighting Dashboard</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/images/logo.png">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Roboto:wght@400;500;700&display=swap"
        rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/dashboard.css">

</head>

<body class="dark-mode">
    <div class="dashboard-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <img src="/images/logo.png" alt="Hue Logo" class="logo-img" />
                </div>
            </div>

            <div class="sidebar-content">
                <div class="connection-status" th:classappend="${connected ? 'connected' : 'disconnected'}">
                    <div class="status-indicator"></div>
                    <div class="status-text">
                        <span th:text="${connected ? 'Connected' : 'Disconnected'}">Status</span>
                        <small th:text="${bridgeIp}">Bridge IP</small>
                    </div>
                </div>

                <nav class="sidebar-nav">
                    <a href="#" class="nav-item active" data-page="control-panel">
                        <i class="fas fa-sliders-h"></i>
                        <span>Control Panel</span>
                    </a>

                    <a href="#" class="nav-item" data-page="saved-scripts">
                        <i class="fas fa-bookmark"></i>
                        <span>Saved Scripts</span>
                    </a>
                    <a href="#" class="nav-item" data-page="scenes">
                        <i class="fas fa-theater-masks"></i>
                        <span>Scenes</span>
                    </a>
                    <a href="#" class="nav-item" data-page="settings">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </a>
                </nav>

                <div class="sidebar-footer">
                    <button id="theme-toggle" class="theme-toggle">
                        <i class="fas fa-moon"></i>
                        <span>Dark Mode</span>
                    </button>

                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="navbar">
                <div class="navbar-left">
                    <h1 id="page-title">Control Panel</h1>
                </div>
                <div class="navbar-right">
                    <button id="emergency-stop" class="btn btn-danger">
                        <i class="fas fa-power-off"></i>
                        <span>Emergency Stop</span>
                    </button>

                    <button>
                        <button onclick="window.location.href='/editor'" class="btn btn-outline-primary">
                            <i class="fas fa-edit"></i>
                            <span>Script Editor</span>
                        </button>

                </div>
            </div>

            <!-- Content Pages -->
            <div class="content-wrapper">
                <!-- Control Panel Page -->
                <div id="control-panel" class="content-page active">
                    <div class="row">
                        <!-- Light Control Card -->
                        <div class="col-lg-4 col-md-6">
                            <div class="card light-control-card">
                                <div class="card-header">
                                    <h3>Light Control</h3>
                                </div>
                                <div class="card-body">
                                    <div class="light-power-control">
                                        <div class="power-button-wrapper">
                                            <button id="light-power" class="power-button"
                                                th:classappend="${lightsOn ? 'on' : 'off'}">
                                                <i class="fas fa-power-off"></i>
                                            </button>
                                            <span class="power-label" th:text="${lightsOn ? 'ON' : 'OFF'}">OFF</span>
                                        </div>
                                        <div class="power-buttons">
                                            <button id="all-lights-on" class="btn btn-success">All Lights ON</button>
                                            <button id="all-lights-off" class="btn btn-secondary">All Lights
                                                OFF</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Brightness Control Card -->
                        <div class="col-lg-4 col-md-6">
                            <div class="card brightness-control-card">
                                <div class="card-header">
                                    <h3>Brightness</h3>
                                </div>
                                <div class="card-body">
                                    <div class="brightness-control">
                                        <div class="brightness-slider-container">
                                            <input type="range" id="brightness-slider" class="brightness-slider" min="0"
                                                max="100" th:value="${lastBrightness}">
                                            <div class="brightness-value">
                                                <span id="brightness-percentage"
                                                    th:text="${lastBrightness} + '%'">100%</span>
                                            </div>
                                        </div>
                                        <div class="brightness-buttons">
                                            <button class="btn btn-sm brightness-preset" data-value="25">25%</button>
                                            <button class="btn btn-sm brightness-preset" data-value="50">50%</button>
                                            <button class="btn btn-sm brightness-preset" data-value="75">75%</button>
                                            <button class="btn btn-sm brightness-preset" data-value="100">100%</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Color Control Card -->
                        <div class="col-lg-4 col-md-6">
                            <div class="card color-control-card">
                                <div class="card-header">
                                    <h3>Color</h3>
                                </div>
                                <div class="card-body">
                                    <div class="color-control">
                                        <div class="current-color">
                                            <div id="color-preview" class="color-preview"
                                                th:style="'background-color:' + ${lastColor}"></div>
                                            <input type="color" id="color-picker" class="color-picker"
                                                th:value="${lastColor}">
                                            <span class="color-label">Pick a color</span>
                                        </div>

                                        <!-- Advanced Color Picker Controls -->
                                        <div class="advanced-color-controls mt-3">
                                            <div class="row g-2">
                                                <div class="col-4">
                                                    <label class="form-label form-label-sm">RGB Values</label>
                                                    <div class="rgb-inputs">
                                                        <input type="number" id="rgb-r"
                                                            class="form-control form-control-sm" min="0" max="255"
                                                            placeholder="R">
                                                        <input type="number" id="rgb-g"
                                                            class="form-control form-control-sm" min="0" max="255"
                                                            placeholder="G">
                                                        <input type="number" id="rgb-b"
                                                            class="form-control form-control-sm" min="0" max="255"
                                                            placeholder="B">
                                                    </div>
                                                </div>
                                                <div class="col-4">
                                                    <label class="form-label form-label-sm">Hex Value</label>
                                                    <input type="text" id="hex-input"
                                                        class="form-control form-control-sm" placeholder="#FFFFFF"
                                                        maxlength="7">
                                                </div>
                                                <div class="col-4 d-flex align-items-end">
                                                    <button id="apply-custom-color"
                                                        class="btn btn-primary btn-sm w-100">
                                                        <i class="fas fa-check me-1"></i>Apply Color
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="color-presets">
                                            <button class="color-preset" style="background-color: #FF0000;"
                                                data-color="#FF0000"></button>
                                            <button class="color-preset" style="background-color: #00FF00;"
                                                data-color="#00FF00"></button>
                                            <button class="color-preset" style="background-color: #0000FF;"
                                                data-color="#0000FF"></button>
                                            <button class="color-preset" style="background-color: #FFFF00;"
                                                data-color="#FFFF00"></button>
                                            <button class="color-preset" style="background-color: #00FFFF;"
                                                data-color="#00FFFF"></button>
                                            <button class="color-preset" style="background-color: #FF00FF;"
                                                data-color="#FF00FF"></button>
                                            <button class="color-preset" style="background-color: #FFFFFF;"
                                                data-color="#FFFFFF"></button>
                                            <button class="color-preset" style="background-color: #FFA500;"
                                                data-color="#FFA500"></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Actions Card -->
                        <div class="col-lg-6 col-md-6">
                            <div class="card quick-actions-card">
                                <div class="card-header">
                                    <h3>Quick Actions</h3>
                                </div>
                                <div class="card-body">
                                    <div class="quick-actions">
                                        <button class="quick-action-btn" data-action="relaxMode">
                                            <i class="fas fa-couch"></i>
                                            <span>Relax Mode</span>
                                        </button>
                                        <button class="quick-action-btn" data-action="concentrateMode">
                                            <i class="fas fa-book"></i>
                                            <span>Concentrate</span>
                                        </button>
                                        <button class="quick-action-btn" data-action="energizeMode">
                                            <i class="fas fa-bolt"></i>
                                            <span>Energize</span>
                                        </button>
                                        <button class="quick-action-btn" data-action="nightLight">
                                            <i class="fas fa-moon"></i>
                                            <span>Night Light</span>
                                        </button>
                                        <button class="quick-action-btn" data-action="colorCycle">
                                            <i class="fas fa-sync-alt"></i>
                                            <span>Color Cycle</span>
                                        </button>
                                        <button class="quick-action-btn" data-action="partyMode">
                                            <i class="fas fa-cocktail"></i>
                                            <span>Party Mode</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Status Card -->
                        <div class="col-lg-6 col-md-6">
                            <div class="card status-card">
                                <div class="card-header">
                                    <h3>Status</h3>
                                </div>
                                <div class="card-body">
                                    <div class="status-info">
                                        <div class="status-item">
                                            <div class="status-label">Bridge Status:</div>
                                            <div class="status-value" id="bridge-status"
                                                th:text="${connected ? 'Connected' : 'Disconnected'}">Unknown</div>
                                        </div>
                                        <div class="status-item">
                                            <div class="status-label">Bridge IP:</div>
                                            <div class="status-value" id="bridge-ip" th:text="${bridgeIp}">Unknown</div>
                                        </div>
                                        <div class="status-item">
                                            <div class="status-label">Lights State:</div>
                                            <div class="status-value" id="lights-state"
                                                th:text="${lightsOn ? 'ON' : 'OFF'}">Unknown</div>
                                        </div>
                                        <div class="status-item">
                                            <div class="status-label">Current Color:</div>
                                            <div class="status-value" id="current-color">
                                                <span class="color-indicator"
                                                    th:style="'background-color:' + ${lastColor}"></span>
                                                <span th:text="${lastColor}"></span>
                                            </div>
                                        </div>
                                        <div class="status-item">
                                            <div class="status-label">Current Brightness:</div>
                                            <div class="status-value" id="current-brightness"
                                                th:text="${lastBrightness} + '%'"></div>
                                        </div>
                                        <div class="status-actions">
                                            <button id="refresh-status" class="btn btn-primary">
                                                <i class="fas fa-sync-alt"></i>
                                                <span>Refresh Status</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Script Executor Page -->
                <div id="script-executor" class="content-page">
                    <div class="row">
                        <div class="col-md-8">
                            <div class="card script-card">
                                <div class="card-header">
                                    <h3>Script Executor</h3>
                                </div>
                                <div class="card-body">
                                    <div class="script-editor-container">
                                        <textarea id="script-editor" class="script-editor" placeholder="// Enter your Hue script here...
// Try this sample script to see real-time logging:

// Turn lights on
lights on;
wait 2 sec;

// Change colors with delays to see real-time updates
lights color &quot;red&quot;;
wait 1 sec;
lights color &quot;green&quot;;
wait 1 sec;
lights color &quot;blue&quot;;
wait 1 sec;

// Brightness changes
brightness 50;
wait 1 sec;
brightness 100;
wait 1 sec;

// Final color
lights color &quot;purple&quot;;"></textarea>
                                    </div>
                                    <div class="script-actions">
                                        <button id="run-script" class="btn btn-primary">
                                            <i class="fas fa-play"></i>
                                            <span>Run Script</span>
                                        </button>
                                        <button id="clear-script" class="btn btn-secondary">
                                            <i class="fas fa-trash"></i>
                                            <span>Clear</span>
                                        </button>
                                        <button id="save-script-btn" class="btn btn-outline-primary">
                                            <i class="fas fa-save"></i>
                                            <span>Save Script</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="card console-card">
                                <div class="card-header">
                                    <h3>Console Output</h3>
                                    <button id="clear-console" class="btn btn-sm btn-outline-secondary">
                                        <i class="fas fa-eraser"></i>
                                        <span>Clear Console</span>
                                    </button>
                                </div>
                                <div class="card-body">
                                    <pre id="console-output"
                                        class="console-output">// Console output will appear here...</pre>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card templates-card">
                                <div class="card-header">
                                    <h3>Script Templates</h3>
                                </div>
                                <div class="card-body">
                                    <div class="template-list">
                                        <div class="template-item" data-template="simpleCycle">
                                            <div class="template-header">
                                                <h4>Simple Cycle</h4>
                                                <button class="btn btn-sm btn-outline-primary load-template">
                                                    <i class="fas fa-file-import"></i>
                                                    <span>Load</span>
                                                </button>
                                            </div>
                                            <div class="template-description">
                                                Cycles the lights on and off with brightness changes.
                                            </div>
                                        </div>
                                        <div class="template-item" data-template="colorTransition">
                                            <div class="template-header">
                                                <h4>Color Transitions</h4>
                                                <button class="btn btn-sm btn-outline-primary load-template">
                                                    <i class="fas fa-file-import"></i>
                                                    <span>Load</span>
                                                </button>
                                            </div>
                                            <div class="template-description">
                                                Smoothly transitions between multiple colors.
                                            </div>
                                        </div>
                                        <div class="template-item" data-template="partyMode">
                                            <div class="template-header">
                                                <h4>Party Mode</h4>
                                                <button class="btn btn-sm btn-outline-primary load-template">
                                                    <i class="fas fa-file-import"></i>
                                                    <span>Load</span>
                                                </button>
                                            </div>
                                            <div class="template-description">
                                                Rapid color changes with strobe effects.
                                            </div>
                                        </div>
                                        <div class="template-item" data-template="relaxMode">
                                            <div class="template-header">
                                                <h4>Relax Mode</h4>
                                                <button class="btn btn-sm btn-outline-primary load-template">
                                                    <i class="fas fa-file-import"></i>
                                                    <span>Load</span>
                                                </button>
                                            </div>
                                            <div class="template-description">
                                                Gentle warmth with slow breathing effect.
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Saved Scripts Page -->
                <div id="saved-scripts" class="content-page">
                    <div class="row">
                        <div class="col-lg-8">
                            <div class="card saved-scripts-card">
                                <div class="card-header">
                                    <h3>Saved Scripts</h3>
                                </div>
                                <div class="card-body">
                                    <div id="saved-scripts-list" class="saved-scripts-list">
                                        <!-- Saved scripts will be loaded dynamically -->
                                        <div class="no-scripts-message">
                                            <i class="fas fa-folder-open"></i>
                                            <p>No saved scripts found</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="card script-preview-card">
                                <div class="card-header">
                                    <h3>Script Preview</h3>
                                    <div class="script-preview-actions">
                                        <button id="execute-preview-script" class="btn btn-sm btn-primary" disabled>
                                            <i class="fas fa-play"></i>
                                            <span>Execute</span>
                                        </button>
                                        <button id="load-to-editor" class="btn btn-sm btn-outline-primary" disabled>
                                            <i class="fas fa-edit"></i>
                                            <span>Edit</span>
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div id="script-preview-content" class="script-preview-content">
                                        <div class="no-script-selected">
                                            <i class="fas fa-file-code"></i>
                                            <p>Select a script to preview</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card console-card mt-3">
                                <div class="card-header">
                                    <h3>Console Output</h3>
                                    <button id="clear-saved-scripts-console" class="btn btn-sm btn-outline-secondary">
                                        <i class="fas fa-eraser"></i>
                                        <span>Clear</span>
                                    </button>
                                </div>
                                <div class="card-body">
                                    <pre id="saved-scripts-console-output"
                                        class="console-output">// Console output will appear here...</pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Scenes Page -->
                <div id="scenes" class="content-page">
                    <div class="card scenes-card">
                        <div class="card-header">
                            <h3>Light Scenes</h3>
                        </div>
                        <div class="card-body">
                            <div class="scenes-grid">
                                <div class="scene-item" data-scene="relaxScene">
                                    <div class="scene-preview" style="background-color: #FF9900;"></div>
                                    <div class="scene-info">
                                        <h4>Relax</h4>
                                        <p>Warm light for relaxation</p>
                                    </div>
                                    <button class="btn btn-primary activate-scene">Activate</button>
                                </div>
                                <div class="scene-item" data-scene="concentrateScene">
                                    <div class="scene-preview" style="background-color: #CCE5FF;"></div>
                                    <div class="scene-info">
                                        <h4>Concentrate</h4>
                                        <p>Cool blue for focus</p>
                                    </div>
                                    <button class="btn btn-primary activate-scene">Activate</button>
                                </div>
                                <div class="scene-item" data-scene="energizeScene">
                                    <div class="scene-preview" style="background-color: #80CAFF;"></div>
                                    <div class="scene-info">
                                        <h4>Energize</h4>
                                        <p>Bright cool light</p>
                                    </div>
                                    <button class="btn btn-primary activate-scene">Activate</button>
                                </div>
                                <div class="scene-item" data-scene="readingScene">
                                    <div class="scene-preview" style="background-color: #FFE0B2;"></div>
                                    <div class="scene-info">
                                        <h4>Reading</h4>
                                        <p>Soft warm light</p>
                                    </div>
                                    <button class="btn btn-primary activate-scene">Activate</button>
                                </div>
                                <div class="scene-item" data-scene="nightlightScene">
                                    <div class="scene-preview" style="background-color: #800080;"></div>
                                    <div class="scene-info">
                                        <h4>Night Light</h4>
                                        <p>Dim purple glow</p>
                                    </div>
                                    <button class="btn btn-primary activate-scene">Activate</button>
                                </div>
                                <div class="scene-item" data-scene="movieScene">
                                    <div class="scene-preview" style="background-color: #3D2C8D;"></div>
                                    <div class="scene-info">
                                        <h4>Movie</h4>
                                        <p>Dim ambient light</p>
                                    </div>
                                    <button class="btn btn-primary activate-scene">Activate</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Page -->
                <div id="settings" class="content-page">
                    <div class="card settings-card">
                        <div class="card-header">
                            <h3>Settings</h3>
                        </div>
                        <div class="card-body">
                            <div class="settings-section">
                                <h4>Application Settings</h4>
                                <div class="setting-item">
                                    <div class="setting-label">Dark Mode</div>
                                    <div class="setting-control">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="darkModeSwitch" checked>
                                            <label class="form-check-label" for="darkModeSwitch">Enable Dark
                                                Mode</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">Auto-refresh Status</div>
                                    <div class="setting-control">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="autoRefreshSwitch"
                                                checked>
                                            <label class="form-check-label" for="autoRefreshSwitch">Enable
                                                Auto-refresh</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">Refresh Interval</div>
                                    <div class="setting-control">
                                        <select id="refreshInterval" class="form-select">
                                            <option value="5000">5 seconds</option>
                                            <option value="10000">10 seconds</option>
                                            <option value="30000" selected>30 seconds</option>
                                            <option value="60000">1 minute</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="settings-section">
                                <h4>Bridge Information</h4>
                                <div class="setting-item">
                                    <div class="setting-label">Bridge IP</div>
                                    <div class="setting-control">
                                        <input type="text" id="bridgeIpInput" class="form-control"
                                            th:value="${bridgeIp}" placeholder="192.168.1.x">
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">API Key</div>
                                    <div class="setting-control">
                                        <input type="text" id="apiKeyInput" class="form-control" th:value="${apiKey}"
                                            placeholder="Enter Hue API key">
                                        <small class="text-muted">Your Hue Bridge API key</small>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">Actions</div>
                                    <div class="setting-control">
                                        <button id="save-bridge-settings" class="btn btn-primary">Save Bridge
                                            Settings</button>
                                        <button id="test-connection" class="btn btn-outline-primary ms-2">Test
                                            Connection</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Save Script Modal -->
    <div class="modal fade" id="saveScriptModal" tabindex="-1" aria-labelledby="saveScriptModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="saveScriptModalLabel">Save Script</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="scriptName" class="form-label">Script Name</label>
                        <input type="text" class="form-control" id="scriptName" placeholder="My Awesome Script">
                    </div>
                    <div class="mb-3">
                        <label for="scriptDescription" class="form-label">Description (Optional)</label>
                        <textarea class="form-control" id="scriptDescription" rows="2"
                            placeholder="Brief description of what this script does"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="confirmSaveBtn">Save Script</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notifications -->
    <div id="notification-container"></div>

    <!-- jQuery, Bootstrap and other JS libraries -->
    <script src="https://code.jquery.com/jquery-3.6.3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>

    <!-- Custom JS -->
    <script src="/js/dashboard.js"></script>
</body>

</html>